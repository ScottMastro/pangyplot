<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>PangyPlot</title>
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='images/favicon.svg') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/colors.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">   
    <link rel="stylesheet" href="{{ url_for('static', filename='css/option-button.css') }}">   
    <link rel="stylesheet" href="{{ url_for('static', filename='css/navbar.css') }}">   
    <link rel="stylesheet" href="{{ url_for('static', filename='css/fonts.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/citation-modal.css') }}">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  

</head>

<body>

{% include 'citation-modal.html' %}

{% include 'navbar.html' %}

<div id="cytoband-container">
    <div id="genome-container">
        <div id="genome-cytoband-container"></div> 

        <div id="other-chr-selector-container">
        <select id="other-chr-selector" name="chr-selector">
            <!-- The options will be appended here by JavaScript -->
        </select>
        <input type="submit" value="Submit">
        </div> 
    </div>
    <div id="chromosome-container">
        <div id="chromosome-cytoband-container"></div>
        <div id="filter">
            <label for="start-coord">Start:</label>
            <input type="text" id="start-coord" name="start-coord">
            <label for="end-coord">End:</label>
            <input type="text" id="end-coord" name="end-coord"><br><br>
        </div>


        <select id="path-selector" name="path-selector">
            <!-- The options will be appended here by JavaScript -->
        </select>
        <input type="submit" value="Submit">

    </div>
</div>



<div id="color-option-button-container" class="button-container">
    <div class="button-container-title">Color Options</div>
    <input type="radio" id="color-option-btn1" checked>
    <label for="color-option-btn1" class="option-button option-button-selected">
        <img src="{{ url_for('static', filename= 'images/option_allele_frequency.svg') }}"></label>
    
    <input type="radio" id="color-option-btn2">
    <label for="color-option-btn2" class="option-button option-button-unselected">
        <img src="{{ url_for('static', filename= 'images/option_node_size.svg') }}"></label>
  
    <input type="radio" id="color-option-btn3">
    <label for="color-option-btn3" class="option-button option-button-unselected">
        <img src="{{ url_for('static', filename= 'images/option_ref_alt.svg') }}"></label>
  
    <input type="radio" id="color-option-btn4">
    <label for="color-option-btn4" class="option-button option-button-unselected">
        <img src="{{ url_for('static', filename= 'images/option_length.svg') }}"></label>

        <input type="radio" id="color-option-btn5">
        <label for="color-option-btn4" class="option-button option-button-unselected">
            <img src="{{ url_for('static', filename= 'images/option_base_composition.svg') }}"></label>
    
</div>


<div id="graph-container">
    <div class="loader-filter"></div>
    <div class="loader"></div>
    
    <div id="graph-info">
        <div>Node ID: <span id="info-node-id"></span></div>
        <div>Node Type: <span id="info-node-type"></span></div>
        <div>Chromosome: <span id="info-chromosome"></span></div>
        <div>Start: <span id="info-start"></span></div>
        <div>End: <span id="info-end"></span></div>
        <div>Length: <span id="info-length"></span></div>
        <div>Sequence: <span id="info-sequence"></span>
            <button id="info-copy-sequence" title="Copy sequence"><i class="fa fa-copy"></i></button>
        </div>
        <div id="optional-size" style="display: none;">Size: <span id="info-size"></span></div>
        <div id="optional-subtype" style="display: none;">Subtype: <span id="info-subtype"></span></div>
        <div id="optional-number-inside" style="display: none;">Number Inside: <span id="info-number-inside"></span></div>
    </div>
    <div id="graph"></div>

</div>

<button id="download-image-button">Download Image</button>
<script>

    function getFormattedDateTime() {
        const now = new Date();
        const year = now.getFullYear();
        const month = String(now.getMonth() + 1).padStart(2, '0');
        const day = String(now.getDate()).padStart(2, '0');
        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
        const seconds = String(now.getSeconds()).padStart(2, '0');
        return `${year}-${month}-${day}_${hours}-${minutes}-${seconds}`;
    }

    document.getElementById('download-image-button').addEventListener('click', function() {
        const canvas = document.querySelector('.force-graph-container canvas');
        if (!canvas) {
            console.error('Canvas element not found');
            return;
        }
    
        const dateTimeStr = getFormattedDateTime();
        const dataUrl = canvas.toDataURL('image/png');
        const link = document.createElement('a');
        link.download = `pangyplot_${dateTimeStr}.png`;
        link.href = dataUrl;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);    
    });
</script>

<script src="{{url_for('static', filename='javascript/force-graph.min.js')}}"></script>
<script src="{{url_for('static', filename='javascript/d3.js')}}"></script>
<script src="{{url_for('static', filename='javascript/d3-annotation.min.js')}}"></script>
<script src="{{url_for('static', filename='javascript/ui/cytoband/cytoband.js')}}"></script>
<script src="{{url_for('static', filename='javascript/ui/cytoband/genome-drawer.js')}}"></script>
<script src="{{url_for('static', filename='javascript/ui/cytoband/chromosome-drawer.js')}}"></script>

<script src="{{url_for('static', filename='javascript/graph.js')}}"></script>
<script src="{{url_for('static', filename='javascript/graph-construct.js')}}"></script>
<script src="{{url_for('static', filename='javascript/graph-collapse.js')}}"></script>

<script src="{{url_for('static', filename='javascript/draw-helper.js')}}"></script>
<script src="{{url_for('static', filename='javascript/graph-select.js')}}"></script>
<script src="{{url_for('static', filename='javascript/path-manager.js')}}"></script>
<script src="{{url_for('static', filename='javascript/ui/button-selector.js')}}"></script>
<script src="{{url_for('static', filename='javascript/ui/citation-modal.js')}}"></script>


</body>
</html>

